!function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=8)}([function(t,e){t.exports={LOCAL_STORAGE_DATA_KEY:"YACEP_EMO_DATA",LOCAL_STORAGE_INFO_KEY:"YACEP_EMO_INFO",LOCAL_STORAGE_GROUP_MENTION:"CHATPP_GROUP_MENTION",LOCAL_STORAGE_ROOM_SHORTCUT:"CHATPP_ROOM_SHORTCUT",LOCAL_STORAGE_DISABLE_NOTIFY_ROOM:"CHATPP_DISABLE_NOTIFY_ROOM",CHROME_LOCAL_KEY:"CHATPP_CHROME_LOCAL_DATA",CHROME_SYNC_KEY:"CHATPP_CHROME_SYNC_DATA",CHROME_SYNC_GROUP_KEY:"CHATPP_CHROME_SYNC_GROUP",CHROME_SYNC_ROOM_KEY:"CHATPP_CHROME_SYNC_ROOM",CHROME_SYNC_DISABLE_NOTIFY_ROOM_KEY:"CHATPP_CHROME_SYNC_DISABLE_NOTIFY_ROOM",DEFAULT_DATA_URL:"https://dl.dropboxusercontent.com/s/lmxis68cfh4v1ho/default.json?dl=1",ADVERTISEMENT_URL:"https://dl.dropboxusercontent.com/s/jsmceot0pqi8lpk/chatppad.json?dl=1",VERSION_CHROME:"VERSION_CHROME",VERSION_FIREFOX:"VERSION_FIREFOX",VERSION_NAME_DEV:"dev",VERSION_NAME_RELEASE:"final",DEFAULT_IMG_HOST:"https://chatpp.thangtd.com/",DELAY_TIME:6e3,FORCE_TURN_OFF_THUMBNAIL:1,ADVERTISEMENT_LOAD_TIMEOUT:18e5,TO_ALL_MARK:"TO ALL >>>"}},function(t,e,a){var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();var o=a(0),r=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.version=o.VERSION_CHROME,this.app_detail=this.getAppDetail(),this.official_emoticons_data={Default:{name:"Default",link:"https://dl.dropboxusercontent.com/s/lmxis68cfh4v1ho/default.json?dl=1",description:"The default Emoticons data of Chat++"},Vietnamese:{name:"Vietnamese",link:"https://dl.dropboxusercontent.com/s/2b085bilbno4ri1/vietnamese.json?dl=1",description:"Yet another data for people who want to use Vietnamese Emoticons"},Japanese:{name:"Japanese",link:"https://dl.dropboxusercontent.com/s/fdq05pwwtsccrn6/japanese.json?dl=1",description:"Yet another data for people who want to use Japanese Emoticons"},Skype:{name:"Skype",link:"https://dl.dropboxusercontent.com/s/8ew2mdh0v2vcad8/skype.json?dl=1",description:"Skype Original Emoticons"}}}return n(t,[{key:"isChromeVersion",value:function(){return this.version===o.VERSION_CHROME}},{key:"isFirefoxVersion",value:function(){return this.version===o.VERSION_FIREFOX}},{key:"isDevVersion",value:function(){var t=this.app_detail.name;return-1!==t.indexOf(o.VERSION_NAME_DEV,t.length-o.VERSION_NAME_DEV.length)}},{key:"checkDevVersionInternal",value:function(){return localStorage.chatpp_version_name===o.VERSION_NAME_DEV}},{key:"getStorage",value:function(t){return!t&&this.isChromeVersion()?chrome.storage.sync:chrome.storage.local}},{key:"sync",value:function(t,e,a){var n={};n[t]=e,this.getStorage().set(n,function(){a&&a()})}},{key:"getEmoticonDataUrl",value:function(t,e){return t&&this.official_emoticons_data[t]&&(e=this.official_emoticons_data[t].link),e?e.replace("http://i.imgur.com/","https://i.imgur.com/"):null}},{key:"getObjectLength",value:function(t){return Object.keys(t).length}},{key:"htmlEncode",value:function(t){return $("<div/>").text(t).html()}},{key:"getEmoUrl",value:function(t){var e=o.DEFAULT_IMG_HOST+"img/emoticons/"+t;return 0!=t.indexOf("https://")&&0!=t.indexOf("http://")||(e=t),this.htmlEncode(e)}},{key:"parseRoomId",value:function(t){var e=t.match(/\d+/g);if(!e||0==e.length)return null;e=e[0];return/^[0-9]{6,10}$/g.test(e)?e:null}},{key:"reload",value:function(){location.reload()}},{key:"getAppDetail",value:function(){return chrome.app.getDetails()}},{key:"getAppVersion",value:function(){return this.app_detail.version}},{key:"getAppVersionName",value:function(){return this.isDevVersion()?o.VERSION_NAME_DEV:o.VERSION_NAME_RELEASE}},{key:"getAppFullName",value:function(){var t=this.getAppVersionName();return this.app_detail.short_name+" "+this.app_detail.version+" "+t}},{key:"openNewUrl",value:function(t){chrome.tabs.create({url:t})}},{key:"getExtensionPageUrl",value:function(t){return chrome.extension.getURL(t)}},{key:"openNewExtensionPageUrl",value:function(t){this.openNewUrl(this.getExtensionPageUrl(t))}},{key:"validateUrl",value:function(t){return/(https):\/\/(\w+:?\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)}},{key:"validateDropboxUrl",value:function(t){if(!this.validateUrl(t))return!1;var e=!0,a=!1,n=void 0;try{for(var o,r=["https://dl.dropboxusercontent.com/","https://www.dropbox.com/"][Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value;if(t.startsWith(i))return!0}}catch(t){a=!0,n=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw n}}return!1}},{key:"isPage",value:function(t){return $("#page-name").data("page-name")===t}},{key:"setPageTitle",value:function(){$("#chatpp_name").html(this.getAppFullName())}},{key:"setStatus",value:function(t,e){-1===t.indexOf("_status")&&(t+="_status"),localStorage[t]=!!e}},{key:"getStatus",value:function(t){return-1===t.indexOf("_status")&&(t+="_status"),"true"===localStorage[t]||!0===localStorage[t]}},{key:"regexEscape",value:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"generateEmoticonRegex",value:function(t,e){return e=e||this.htmlEncode(this.regexEscape(t)),new RegExp(e,"g")}},{key:"random",value:function(t){return t.length?t[Math.floor(Math.random()*t.length)]:null}},{key:"randomString",value:function(t){for(var e="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<t;n++)e+=a.charAt(Math.floor(Math.random()*a.length));return e}}]),t}());t.exports=r},function(t,e,a){var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();var o=a(1),r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=o.getStorage(e)}return n(t,[{key:"get",value:function(t,e){this.storage.get(t,function(a){a=a?a[t]:void 0,e(a)})}},{key:"set",value:function(t,e,a){var n={};n[t]=e,this.storage.set(n,function(){a&&a()})}},{key:"setData",value:function(t,e){this.storage.set(t,function(){e&&e()})}}]),t}();t.exports=r},,function(t,e,a){var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();var o=a(1),r=a(2),i=a(0),s=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.data={},t.data_count=0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),n(e,[{key:"getDataCount",value:function(){return o.getObjectLength(this.data)}},{key:"setFeatureStatus",value:function(t){var e=["mention","shortcut","thumbnail","highlight","emoticon"];for(var a in e){var n=e[a]+"_status";this.data[n]=void 0===t[n]||t[n]}this.data.force_update_version=t.force_update_version}},{key:"pushData",value:function(t,e){var a=void 0!==e?e:t.priority;void 0===this.data[t.data_name]&&this.data_count++,this.data[t.data_name]={priority:a,data_name:t.data_name,data_url:t.data_url,data_changelog:t.data_changelog,data_version:t.data_version,date_sync:(new Date).toLocaleString()}}},{key:"removeData",value:function(t){void 0!==this.data[t]&&delete this.data[t]}},{key:"syncData",value:function(t){this.set(i.CHROME_SYNC_KEY,this.data,t)}}]),e}();t.exports=s},,,,function(t,e,a){a(9),a(10),a(11),a(12),a(13),t.exports=a(14)},function(t,e,a){var n=a(1),o=a(0),r=a(4),i=new r,s=[],c={},u={},l=!1,d=n.official_emoticons_data;function f(t,e){$.isEmptyObject(t)&&(t.Default=o.DEFAULT_DATA_URL);var a=[];$.each(t,function(o,r){-1===a.indexOf(r)&&(a.push(r),$.getJSON(r).done(function(a){if(void 0!==a.data_version&&void 0!==a.emoticons){a.data_url=t[a.data_name]?t[a.data_name]:t.added;var o=function(t){var e=0;for(var a in c){var n=c[a];if(n.data_name===t)return n.priority;n.priority>=e&&(e=n.priority+1)}return e}(a.data_name);i.pushData(a,o),function(t,e,a){for(var n=0;n<t.length;n++){var o=!1;t[n].priority=e;for(var r=0;r<s.length;r++)if(s[r].emo.key===t[n].key){s[r].emo.priority<t[n].priority?s[r].status=!0:o=!0;break}s.push({emo:t[n],status:o,data_name:a})}}(a.emoticons,o,a.data_name),i.data_count===n.getObjectLength(t)&&i.syncData(e)}else bootbox.alert("Invalid data structure!")}).fail(function(){var t="<span class='text-danger'>There is an error occurred when loading or parsing the following url: <br><a href='"+r+"'>"+r+"</a><br>It may be because of the failure in downloading file or invalid file format.<br>Check your file data carefully and try to reload again.</span>";bootbox.alert(t)}))})}function p(){location.reload()}function _(){$(".table-emo > tbody").html("");var t=i.data;"Default"!=t.data_name&&t.data_url&&($("#data-select").val("custom"),$("#data-url").val(t.data_url),$("#url-input-div").show("slow"),$("#btn-show-changelog").show("slow"));var e="",a=null,o=0,r=null;$.each(s,function(t,i){a&&a===i.data_name||(e&&$("#table-emo-"+r).find("tbody").append(e),a=i.data_name,e="",o=t),r=i.data_name,(t-o)%4==0&&(e+="<tr>"),e+=function(t){var e=n.htmlEncode(n.getEmoUrl(t.emo.src)),a="",o=t.status?"danger":"info";return a+="<td class='"+o+" text-center'>"+t.emo.key+"</td>",a+="<td class='text-center'><img class='emoticon' src='"+e+"'/></td>"}(i),(t-o)%4==3&&(e+="</tr>")}),$("#table-emo-"+r).find("tbody").append(e)}function v(t){$("#table-data > tbody").html("");var e="",a=!0;$.each(t.slice().reverse(),function(t,n){if(void 0!==n.data_name&&void 0!==n.data_url){var o=a?"disabled":"";a=!1,e+="<tr>",e+="<td class='text-center'>"+n.data_name+"</td>",e+="<td class='text-center'>"+n.data_version+"</td>",e+="<td class='text-center'>"+function(t){if(!t)return"";return $("<a>",{href:t,text:t,target:"_blank"}).prop("outerHTML")}(n.data_url)+"</td>",e+="<td class='text-center'><button class='btn btn-primary btn-sm btn-data-move-up "+o+"' data-priority='"+n.priority+"' id='btn-move-up"+n.data_name+"'> Move Up </button><button class='btn btn-warning btn-sm btn-data-remove' data-name='"+n.data_name+"' id='btn-"+n.data_name+"'> Remove </button></td>",e+="</tr>"}}),$("#table-data").find("tbody").append(e)}$(function(){n.isPage("emoticon")&&(n.setPageTitle(),i.get(o.CHROME_SYNC_KEY,function(t){if(!$.isEmptyObject(t))for(var e in c=t,i.setFeatureStatus(c),t){var a=t[e],o=n.getEmoticonDataUrl(a.data_name,a.data_url);o&&(u[a.data_name]=o)}var s,m,h;$.isEmptyObject(u)&&(l=!0,u.Default=n.getEmoticonDataUrl("Default")),m=c,h=[],$.each(m,function(t,e){void 0!==e.priority&&(h[e.priority]=e)}),v(s=function(t){var e=0,a=[];for(var n in t)t[n].priority=e,a[e++]=t[n];return a}(h)),$.each(s.slice().reverse(),function(t,e){var a,n;void 0!==e.data_name&&void 0!==e.data_url&&(a=e.data_name,n='<div id="emoticons-table"><div class="panel panel-warning"><div class="panel-heading">'+a+'</div><table class="table table-emo table-bordered" id="table-emo-'+a+'"><thead><tr class="success text-center"><th colspan="2" class="text-center">Emo</th><th colspan="2" class="text-center">Emo</th><th colspan="2" class="text-center">Emo</th><th colspan="2" class="text-center">Emo</th></tr></thead><tbody></tbody></table></div>',$("#emoticons-table").append(n))}),$("#btn-save").click(function(){var t=new r;for(var e in s)t.pushData(s[e],s[e].priority);t.syncData(p)}),$("#table-data").on("click","button",function(t){var e=$(t.currentTarget);if(e.hasClass("btn-data-move-up")){var a=e.data("priority"),n=void 0,o=a+1;s[o]&&(n=s[o],s[o]=s[a],s[a]=n,s[o].priority=o,s[a].priority=a),v(s)}if(e.hasClass("btn-data-remove")){var r=e.data("name");i.removeData(r),i.syncData(p)}}),l?f(u,p):(f(u,_),function(){var t=$("#official-data");for(var e in d)if(void 0===c[e]){var a='<div class="col-md-12 official-data"><button class="btn btn-info btn-sm btn-official-data" data-name="'+e+'">Add '+e+'</button><span class="text-primary" style="padding-left: 20px"><strong>'+d[e].description+"</strong></span></div><br>";t.append(a)}$(".btn-official-data").click(function(t){var e=$(t.currentTarget).data("name"),a=d[e].link;n.validateUrl(a)&&(u[e]=a,f(u,p))})}())}),$("#btn-reset").click(function(){bootbox.dialog({title:"<span class='text-primary'>Reset Emoticon Data",message:"<span class='text-danger'>Your are trying to reset emoticon data, which will clear your current data information.<br>This action cannot be undone. Are you sure ?</span>",buttons:{success:{label:"OK!",className:"btn-success",callback:function(){c={},f({},p)}},danger:{label:"Cancel!",className:"btn-danger"}}})}),$("#btn-load").click(function(){if("default"==$("#data-select").val())f(o.DEFAULT_DATA_URL,p);else{var t=$("#data-url").val();n.validateDropboxUrl(t)?bootbox.dialog({message:'The data from <a href="'+t+'">'+t+"</a> may contain undesirable emoticons and we will not be responsible for it",title:"<span class='text-danger'>Your are trying to load data that is not officially supported by Chat++.<br/> Do you want to continue ?</span>",buttons:{success:{label:"OK!",className:"btn-success",callback:function(){u.added=t,f(u,p)}},danger:{label:"Cancel!",className:"btn-danger",callback:function(){}}}}):bootbox.alert("Invalid URL! Make sure your inputted URL is correct, and a Dropbox link!")}}),$("#data-select").change(function(t){"default"==$(t.currentTarget).val()?$("#url-input-div").hide("slow"):$("#url-input-div").show("slow")}))})},function(t,e,a){var n=a(1);$(function(){n.isPage("shortcut")&&n.setPageTitle()})},function(t,e,a){var n=a(0),o=a(1),r=new(a(2)),i=[];$(function(){o.isPage("notification")&&(o.setPageTitle(),r.get(n.CHROME_SYNC_DISABLE_NOTIFY_ROOM_KEY,function(t){$.isEmptyObject(t)||(i=t,$("textarea").val(i.join()))}),$("#save-btn").click(function(){var t=$("textarea").val().split(",");i=[],$.each(t,function(t,e){var a=o.parseRoomId(e);a&&i.push(a)}),r.set(n.CHROME_SYNC_DISABLE_NOTIFY_ROOM_KEY,i,o.reload)}))})},function(t,e,a){var n=a(0),o=a(1),r=new(a(2)),i=[];$(function(){o.isPage("room")&&(o.setPageTitle(),r.get(n.CHROME_SYNC_ROOM_KEY,function(t){$.isEmptyObject(t)||(i=t,function(){for(var t in i)i[t]&&$("[data-btn='"+t+"']").val(i[t])}())}),$("#save-btn").click(function(){$("input").each(function(t,e){var a=$(e).data("btn"),n=$(e).val();i[a]=o.parseRoomId(n)}),r.set(n.CHROME_SYNC_ROOM_KEY,i,o.reload)}))})},function(t,e,a){var n=a(0),o=a(1),r=new(a(2)),i={};function s(t,e){void 0!==e&&!1===e?($("#"+t+"-status").removeClass().addClass("text-danger").html("DISABLED"),$("#"+t+"-status-btn").removeClass().addClass("btn btn-success btn-xs").html("Enable")):($("#"+t+"-status").removeClass().addClass("text-success").html("ENABLED"),$("#"+t+"-status-btn").removeClass().addClass("btn btn-danger btn-xs").html("Disable"))}$(function(){o.isPage("setting")&&(o.setPageTitle(),r.get(n.CHROME_SYNC_KEY,function(t){i[n.CHROME_SYNC_KEY]=t,$.isEmptyObject(t)?o.openNewExtensionPageUrl(o.app_detail.options_page):(!function(t){var e=["emoticon","mention","shortcut"];for(var a in e)s(e[a],t[e[a]+"_status"])}(t),$("[id$=-status-btn]").click(function(t){var e=!0,a=$(t.currentTarget).attr("id").split("-")[0];"Disable"===$(t.currentTarget).html()&&(e=!1),i[n.CHROME_SYNC_KEY][a+"_status"]=e,r.setData(i,function(){s(a,e)})}))}))})},function(t,e,a){var n=a(0),o=a(1),r=new(a(2)),i=[];function s(){var t="",e=$("#table-data").find("tbody");e.html(""),$.each(i,function(e,a){void 0!==a.group_name&&void 0!==a.group_members&&(t+="<tr id='row-"+e+"'>",t+="<td class='text-center'>"+a.group_name+"</td>",t+="<td class='text-center'>"+a.group_members+"</td>",t+="<td class='text-center'><button class='btn btn-warning btn-sm btn-data-remove' data-name='"+a.group_name+"'id='btn-"+e+"'> Remove </button></td>",t+="</tr>")}),e.append(t),$(".btn-data-remove").click(function(t){!function(t){var e=-1;$.each(i,function(a,n){t==n.group_name&&(e=a)}),e>=0&&i.splice(e,1)}($(t.currentTarget).data("name")),c()})}function c(t){void 0===t&&(t=s),r.set(n.CHROME_SYNC_GROUP_KEY,i,t)}$(function(){if(o.isPage("group")){o.setPageTitle(),r.get(n.CHROME_SYNC_GROUP_KEY,function(t){$.isEmptyObject(t)||(i=t,c())});var t=$("#data-group-name"),e=$("#data-group-members");$("#button-group-add").click(function(){var e={};e.group_name=t.val().trim();var a=function(t){for(var e=t.split(","),a=[],n=0;n<e.length;n++){var o=e[n];(o=o.trim())&&$.isNumeric(o)&&-1===a.indexOf(o)&&a.push(o)}var r=/\[[a-zA-Z]+:([0-9]+)\]/g,i=void 0;for(;null!=(i=r.exec(t));)a.push(i[1]);return a}($("#data-group-members").val());(function(t){if(t.length>15||t.length<2)return!1;return t.split(" ").length-1<=2})(e.group_name)&&a.length>0&&(e.group_members=a.join(", "),function(t){var e=!1;$.each(i,function(a,n){t.group_name==n.group_name&&(i[a]=t,e=!0)}),e||i.push(t)}(e),c(),$("#data-group-name").val(""),$("#data-group-members").val(""),t.focus())}),t.keyup(function(t){13==t.keyCode&&e.focus()}),e.keyup(function(t){13==t.keyCode&&$("#button-group-add").trigger("click")})}})}]);